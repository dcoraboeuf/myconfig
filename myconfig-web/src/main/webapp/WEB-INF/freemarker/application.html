<#include "/lib/layout.html">
<@layout_std pageId="application" style=false modules=["crud","items","key"]>
	<article class="application">
		<h1>${application.name?html}</h1>
		<section id="app-versions">
			<h1><@lh key="application.versions" /></h1>
			<@items_table id="versions" headers=["model.version.name","application.version.keyCount"] actions=true>
				<@items items=application.versionSummaryList ; item>
					<@item_column field="name" item=item />
					<@item_column field="keyCount" item=item />			
					<@item_actions item=item>
						<@item_delete item=item action="gui/application/${application.id}/version/delete" formField="name" promptKey="version.delete" />
						<@item_edit action="gui/configuration/${application.id}/${item.name}" />
					</@item_actions>
				</@items>
				<@items_commands>
					<@item_create id="version-create" action="gui/application/${application.id}/version/create" label="application.version.new" />
					<@item_error key="version_error" />
				</@items_commands>
			</@items_table>
		</section>
		<section id="app-environments">
			<h1><@lh key="application.environments" /></h1>
			<@crud_table items = application.environmentSummaryList errorKey = "environment_error">
				<@crud_column property="name" key="model.environment.name" />
				<@crud_create id="environment" action="gui/application/${application.id}/environment/create" label="application.environment.new" />
				<@crud_delete action="gui/application/${application.id}/environment/delete" field="name" promptKey="environment.delete" />
			</@crud_table>
		</section>
		<section id="app-keys">
			<h1><@lh key="application.keys" /></h1>
			<@crud_table items = application.keySummaryList errorKey = "key_error">
				<@crud_column property="name" key="model.key.name" />
				<@crud_column property="description" key="model.key.description" />
				<@crud_column property="versionCount" key="application.key.versionCount" class="crud-number" />
				<@crud_delete action="gui/application/${application.id}/key/delete" field="name" promptKey="key.delete" />
				<@crud_general_action>
					<@key_create formClass="crud" action="gui/application/${application.id}/key/create" />
				</@crud_general_action>
			</@crud_table>
		</section>
	</article>
	<@layout_std_nav href="gui/" key="applications" />
	<@layout_std_nav href="gui/matrix/${application.id}" key="matrix" />
</@layout_std>