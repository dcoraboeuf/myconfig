<#-- Resources -->
<link rel="stylesheet/less" type="text/css" href="less/modules/crud.less" />

<#macro crud_table items>
	<#assign columns = [] >
	<#nested>
	<table class="crud">
		<thead>
			<tr>
				<#list columns as column>
					<th>
						<@lh key=column.key />
					</th>
				</#list>
				<th>
				</th>
			</tr>
		</thead>
		<tbody>
			<#list items as item>
				<tr>
					<#list columns as column>
						<td>
							${item[column.property]}
						</td>
					</#list>
					<td>
						<#if deletion??>
							<form class="crud-action crud-delete" action="${deletion.action}" method="post">
								<input type="hidden" name="${deletion.field}" value="${ item[deletion.field] }" />
								<input class="crud-action crud-delete" type="image" src="images/crud/delete.png" />
							</form>
						</#if>
					</td>
				</tr>
			</#list>
		</tbody>
		<tfoot>
			<tr>
				<td colspan="${ columns?size + 1 }">
					<#if creation??>
						<form class="crud-create" action="${creation.action}" method="post">
							<label>
								<@lh key=creation.label />
								<input id="${creation.id}_${creation.field}_text" name="${creation.field}" type="text" maxlength="${creation.maxlength}" size="${creation.size}" />
								<input type="submit" value="<@lh key=creation.submit />" />
							</label>
						</form>
					</#if>
				</td>
			</tr>
		</tfoot>
	</table>
</#macro>

<#macro crud_column property key>
	<#assign columns = columns + [{"property": property, "key": key}] >
</#macro>

<#macro crud_create action label="general.create.label" field="name" id="" maxlength="80" size="20" submit="general.create">
	<#assign creation = {"action": action,
		"label": label,
		"field": field,
		"id": id,
		"maxlength": maxlength,
		"size": size,
		"submit": submit
	} />
</#macro>

<#macro crud_delete action field="id">
	<#assign deletion = {
		"action": action,
		"field": field
	} />
</#macro>